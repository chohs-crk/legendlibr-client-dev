지금부터 정해진 양식에 맞게 캐릭터 생성 흐름을 만들 예정이야
진행 상황은 
nowflow(refine, story1, story2, story3, final)
called(T or F)
resed(T or F)
1. 기원, 지역 선택
이 부분은 이미 만들어져 있다
2. 유저 프롬포트 입력 후 생성하기 버튼 누르기
3. 생성하기 버튼을 눌러서 서버가 호출 되면, 서버는 origin과 region id를 각각 파일, db에서 읽고
origin name과 desc, region name과 detail, 유저 입력 이름, 유저 입력 프롬프트를 받는다
유저 입력 이름은 1~20글자 사이 고정, 프롬포트는 1~1000byte 고정
만족하지 않을 시 즉시 생성 실패
그리고 위 과정 성공 시 현재 진행 상황을 refine, T, F로 한다
ai 호출을 한다. 여기서 safetyscore, realname, rewritten, storytheme을 받는다
rewritten은 유저가 입력한 프롬포트의 길이를 반영하여 400자부터 600자 사이로 한다
받은 뒤 진행 상황을 story1, F, F로 한다
4. ai 호출을 바탕으로 첫 번째 호출에  스토리, 선택지, 각각의 메리트를 1-10점으로 받는다. 이후 높은 순서대로 3, 2, 1점으로 환산한다. 점수가 9 9 8점이면 3 3 1점, 7 9 8점이면 1, 3, 2 이런 식으로 변형한다
입력하는 내용은 
첫 스토리 생성에는 origin과 region 관련 설명, realname, rewritten, storytheme을 넣고 400자 분량
이후 스토리 생성에는 이전 스토리 내용과 유저 선택, realname, rewritten, storytheme을 넣고 300자 분량
프론트에는 스토리와 선택지 번호(0~2)만 보내지며, 점수는 알 수 없다. 선택 시 다음 장면으로 넘어가며 스토리 2, 스토리 3도 같은 방식으로 한다.
ai 호출 전에는 현재 스토리 넘버를 가지고 있다, F, F. ai 호출을 시도 한 뒤에는 현재 스토리 넘버, T, F. 스토리 생성 과정은 스트리밍 형식 api 호출이며 이 호출이 완전히 성공하면 현재 스토리 넘버, T, T. 유저가 선택지를 선택하면 다음 스토리 넘버, F, F로 변경


이 전체 과정에서 기본 서버 메모리를 사용한다. 서버에는 스토리와 선택지 번호만 전송하며 서버 메모리를 통해 위 과정에서의 신뢰를 확보한다

5. 세 번째 선택지 까지 선택되면 
선택지 스코어의 합을 계산하고 
스토리를 한번 재가공하여 결말과 캐릭터가 사용할 4개의 스킬을 만든다.
결말은 스코어의 합이 3~6이면 배드엔딩, 7~9이면 해피엔딩으로 프롬포트를 다르게 한다
4개의 스킬은 각각 name, shortdesc, longdesc, power 값을 갖는다.
이름, 짧은 설명, 자세한 설명, 1-10 사이의 위력을 의미
그 다음 region 정보, rewritten, finalstory, skill 정보를 바탕으로 캐릭터 점수를 평가한다
항목은 지역 세계관과 어울리는가? 묘사가 다채로운가? TRPG의 무결점 절대자에 가까운가? 규칙을 무시하는가? 전투에 어울리는가? 보조 등의 행위에 어울리는가? 스토리의 짜임새가 출중한가? 등의 요소를 1-10점 사이로 받는다

이후 db에 저장한다

