구조
0. 매칭이란? 자신이 공격자(enemy는 수비자)이고 finished가 false인 문서를 매칭 문서로 칭함
이게 잇으면 매칭 잡혀있는거 없으면 안잡혀있는거
매칭과 aiready 자체는 별개 작업이지만, 매칭이 잡혀 있으면 aiready가 반드시 시행되어야 함
1. 파일에 처음 들어오거나(맨 위 캐릭터 로딩됨), 캐릭터를 바꾸는 등 행위를 하면
그 캐릭터가 이미 매칭이 잡혀 있는지 확인
잡혀 있으면 그 정보 불러오기, 아니면 새로 매칭을 시작한다
2. 새로 매칭 시작하고 위 파일의 캐릭터 매칭 알고리즘으로 매칭, 그 다음에 ai battle init를 통해 비동기 호출을 한다(유저가 다른 모드를 하다 와도 자동으로 호출은 이어져서 바로  플레이 가능하게)
즉 
진입->
매칭->
ai 호출과, 매칭 정보 프론트로 보내기 분리하기
battle js는 리턴해서 종료되나
ai 호출은 return 없이 db에 저장함으로서 위 로직을 만족하도록 한다

추가적인 케이스 고려
1. 상대 캐릭터가 없을 수 있음(매칭 잡히고 나서 삭제함)
이건 배틀 로드를 넘어서 controller로 넘어가도 문제 될 수 있는지 확인해줘
상대 정보를 이미 받아온 상태(추가적으로 캐릭터 db에는 접근 불필요하고 스토리지랑 배틀 문서db에만 접근해도 될 때)로 배틀을 지속해서 controller에서 finished true로 바꾸면 문제 없음
이건 기존 매칭 문서 아예 없애버리고 새로 만들어야 함
2. 매칭 잡혔는데 2분 넘게 aiready가 false다->이것도 문서 파기해야함

-매칭은 내 점수 +-100점에서 잡는다
-매칭 후보(위 범위 내 점수를 가진 캐릭터)가 10명 미만이면 범위를 +-100만큼 늘린다
-내 매칭은 한번에 하나만 존재 가능하지만, 한 캐릭터가 동시에 여러 매칭을 받고 있는 상태는 가능하다
-매칭이 존재하는지 여부는, 공격자가 나고 동시에 battlefinished가 false

1. 캐릭터 간 매칭은 독립적이며 한 번 매칭되면 다시 들어와도 변하지 않는다
1-1. 단, 매칭을 한 상대 캐릭터가 삭제되었다면 예외
2. 매칭 시 동시에 battles 문서를 새로 만들고 ai 호출을 비동기로 해서 로딩 시간을 최대한 줄인다
3. 한 계정에서 같은 캐릭터의 ai 호출을 동시에 여러번 하진 않으나, 다른 캐릭터 매칭 이후 ai 호출 자체는 여러번 가능하다
